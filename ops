{"version":1,"ops":[{"type":1,"author":{"id":"be6307075155f97d69b94961661b08edd0b4ac58"},"timestamp":1613761579,"metadata":{"github-id":"MDU6SXNzdWU4MTIyNjU4MjQ=","github-url":"https://github.com/rurban/Net-Ping/issues/27","origin":"github"},"title":"Test suite does not support rootless containers.","message":"If you try to run this in a rootless container you'll see a lot of failures.\n\n```\n~/aports/testing/perlcc/src/perl-5.32.1 # PERL5LIB=lib LD_LIBRARY_PATH=. ./perl ./utils/prove -l dist/Net-Ping/t/*\ndist/Net-Ping/t/000_load.t ........... ok   \ndist/Net-Ping/t/001_new.t ............ 1/? icmp socket error - Operation not permitted at dist/Net-Ping/t/001_new.t line 71.\n# Looks like your test exited with 1 just after 9.\ndist/Net-Ping/t/001_new.t ............ Dubious, test returned 1 (wstat 256, 0x100)\nAll 9 subtests passed \ndist/Net-Ping/t/010_pingecho.t ....... ok   \ndist/Net-Ping/t/110_icmp_inst.t ...... 1/2 icmp socket error - Operation not permitted at dist/Net-Ping/t/110_icmp_inst.t line 24.\n# Looks like your test exited with 1 just after 1.\ndist/Net-Ping/t/110_icmp_inst.t ...... Dubious, test returned 1 (wstat 256, 0x100)\nFailed 1/2 subtests \ndist/Net-Ping/t/120_udp_inst.t ....... ok   \ndist/Net-Ping/t/130_tcp_inst.t ....... ok   \ndist/Net-Ping/t/140_stream_inst.t .... ok   \ndist/Net-Ping/t/150_syn_inst.t ....... ok   \ndist/Net-Ping/t/190_alarm.t .......... ok   \ndist/Net-Ping/t/200_ping_tcp.t ....... ok     \ndist/Net-Ping/t/250_ping_hires.t ..... ok   \ndist/Net-Ping/t/300_ping_stream.t .... skipped: loopback tcp echo service is off (Connection refused)\ndist/Net-Ping/t/400_ping_syn.t ....... ok     \ndist/Net-Ping/t/410_syn_host.t ....... ok     \ndist/Net-Ping/t/420_ping_syn_port.t .. ok     \ndist/Net-Ping/t/450_service.t ........ ok     \ndist/Net-Ping/t/500_ping_icmp.t ...... icmp socket error - Operation not permitted at dist/Net-Ping/t/500_ping_icmp.t line 58.\ndist/Net-Ping/t/500_ping_icmp.t ...... Dubious, test returned 1 (wstat 256, 0x100)\nNo subtests run \ndist/Net-Ping/t/501_ping_icmpv6.t .... icmp socket error - Operation not permitted at dist/Net-Ping/t/501_ping_icmpv6.t line 49.\ndist/Net-Ping/t/501_ping_icmpv6.t .... Dubious, test returned 1 (wstat 256, 0x100)\nNo subtests run \ndist/Net-Ping/t/510_ping_udp.t ....... ok   \ndist/Net-Ping/t/520_icmp_ttl.t ....... 1/? icmp socket error - Operation not permitted at dist/Net-Ping/t/520_icmp_ttl.t line 23.\n# Looks like your test exited with 1 just after 1.\ndist/Net-Ping/t/520_icmp_ttl.t ....... Dubious, test returned 1 (wstat 256, 0x100)\nAll 1 subtests passed \n\nTest Summary Report\n-------------------\ndist/Net-Ping/t/001_new.t          (Wstat: 256 Tests: 9 Failed: 0)\n  Non-zero exit status: 1\ndist/Net-Ping/t/110_icmp_inst.t    (Wstat: 256 Tests: 1 Failed: 0)\n  Non-zero exit status: 1\n  Parse errors: Bad plan.  You planned 2 tests but ran 1.\ndist/Net-Ping/t/500_ping_icmp.t    (Wstat: 256 Tests: 0 Failed: 0)\n  Non-zero exit status: 1\n  Parse errors: No plan found in TAP output\ndist/Net-Ping/t/501_ping_icmpv6.t  (Wstat: 256 Tests: 0 Failed: 0)\n  Non-zero exit status: 1\n  Parse errors: No plan found in TAP output\ndist/Net-Ping/t/520_icmp_ttl.t     (Wstat: 256 Tests: 1 Failed: 0)\n  Non-zero exit status: 1\nFiles=20, Tests=132, 53 wallclock secs ( 0.08 usr  0.04 sys +  1.27 cusr  0.23 csys =  1.62 CPU)\nResult: FAIL\n```\n\nThis is because the test suite is not capability aware. It assumes if it has root is has `CAP_NET_RAW`, but it is smart enough to at least know these tests are problematic.\n\n```\nok 9 # skip icmp ping requires root privileges.\nok 10 # skip icmp ping requires root privileges.\nok 11 # skip icmp ping requires root privileges.\n```","files":null}]}